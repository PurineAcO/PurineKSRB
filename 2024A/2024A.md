# 2024 A

### Problem 1

由等距螺线的定义，各个把手所在的位置可以用如下极坐标方程表示

$$r=\frac{55}{2\pi}\theta \tag{1}$$

积分得，等距螺线的弧长为

$$L=\frac{55}{4\pi}\Delta\left(\theta\sqrt{\theta^{2}+1}+\ln\left(\theta+\sqrt{\theta^{2}+1}\right)\right) \tag{2}$$

注: $\Delta$ 的含义为 ${|}^{\theta_{1}}_{\theta_{2}}$ ,另外记 $k=\frac{55}{2\pi}$ ，下同

进而可以得到整个曲线的弧长为 $442.59\mathrm{m}$ ，于是，在 $t$ 时刻后，龙头进入了 $442.59-t$ 处，需要解出 $(2)$ ，即可得到龙头所在的 $\theta_{0}$ .

$$442.59-t=\frac{55}{4\pi}\Delta\left(\theta\sqrt{\theta^{2}+1}+\ln\left(\theta+\sqrt{\theta^{2}+1}\right)\right) \tag{3}$$

下一步计算龙身 $i$ 前把手所在的 $\theta_{i}$ ，由于龙身是一个直线且不可弯曲的刚体，因此当 $t$ 足够大而龙头足够接近螺线中心时，无法用螺线的弧长来代替龙身的直线长度，此时需要进行迭代。  
考虑第 $i$ 个点和 $i+1$ 个点，前者的极坐标为 $(k\theta_{i},\theta_{i})$ ，以之为圆心，做出一个半径为 $r_{0}$ 的圆，其参数方程为

$$r_{i+1}^{2}-2r_{i+1}r_{i}\cos(\theta_{i}-\theta_{i+1})+r_{i}^{2}=r_{0}^{2} \tag{4}$$

其中需要满足 $\theta_{i}<\theta_{i+1}\le 32\pi$ ，代入 $(1)$ 得：

$$\theta_{i+1}^2-2\theta_{i+1}\theta_{i}\cos(\theta_{i+1}-\theta_{i})+r_{i}^{2}=\frac{r_{0}^{2}}{k^{2}} \tag{5}$$

代入 $r_{0}=341-27.5\times 2=286$ ，对每个时刻分别求解 $(2)$ 得到 $\theta_{0}$ ，进而迭代 $(4)$ 得到 $\theta_{i}$  
具体的直角坐标，可以由以下式子得到

$$x_{i}=k\theta_{i}\cos\theta_{i}\tag{6}$$
$$y_{i}=k\theta_{i}\sin\theta_{i}\tag{7}$$

**下面介绍一种新做法**

由于在极坐标中， $v_{0}=\sqrt{v_r^2+v_\theta^2}=\sqrt{\dot{r}^2+(r\dot{\theta})^2}$  
进而代入各个参数得到了

$$||\boldsymbol{v_{0}}||=k|\dot{\theta}|\sqrt{1+\theta^2}\tag{8}$$

化简得到微分方程

$$\frac{\mathrm{d}\theta}{\mathrm{d} t} =\frac{2\pi v_0}{d\sqrt{1+\theta^2}}\tag{9}$$

其初值为$\theta(0)=32\pi$，之后同上

**速度求解**

观察$(5)$式子，并对$t$微分:

$$\theta_{i+1}' \left[ \theta_{i+1} - \theta_i \cos\Delta\theta + \theta_{i+1}\theta_i \sin\Delta\theta \right] +\theta_i' \left[ \theta_i - \theta_{i+1} \cos\Delta\theta - \theta_{i+1}\theta_i \sin\Delta\theta \right] = 0$$

化简得到递推关系

$$\boxed{\frac{\dot{\theta}_{i+1}}{\dot{\theta}_{i}}= \frac{\theta_i - \theta_{i+1} \cos(\theta_{i+1}-\theta_{i}) - \theta_{i+1}\theta_i \sin(\theta_{i+1}-\theta_{i})}{\theta_i \cos(\theta_{i+1}-\theta_{i}) - \theta_{i+1} - \theta_{i+1}\theta_i \sin(\theta_{i+1}-\theta_{i})}}$$

初值 $\dot{\theta}_0=\frac{1}{k\sqrt{\theta_{0}^{2}+1}}$ ，另外由 $(8)$ 得到实际速度。对于本题应该注意所求的龙头索引为 $0$ ，龙尾索引是 $221+1+1=223$ .

### Problem 2

大多数的论文*认为，碰撞会发生在龙头和邻近一圈的龙身之间。这样可以避免进行全局的碰撞检测，只考虑一次，但是无人给出严密的证明，可能这样的证明比较困难，为此，拟采用先粗后细的碰撞检测方法。

先对图形所在的范围有一个粗略的估计，这将采用绘图的方式进行，如在300s处的图形，可见无碰撞痕迹；在400s处，龙头和后面节数开始接近，在450s处Problem 1已经无解析解，说明到了终点，因此可能存在碰撞的区间已经至少缩小到了400~450s之间。  

观察400s时的图形，进行加细研究。可以观察到，龙头部分靠外侧的端点更可能发生碰撞，而其他端点等价，可先不考虑。先粗略检测，已经注意到首次碰撞发生的位置一定存在于最内侧一圈和其外侧邻圈，考虑龙头的 $\theta_{0}$ 和能够满足 $\frac{7\pi}{4}<\theta_{i}-\theta_{0}<2\pi$ 的 $i$ 龙身，对涉及的区域标注。  

实验发现，在 $t\in(412,413)$ 区间存在明显接触迹象，其中 $t=420$ 时未接触， $t=420.5$ 已接触；在 $t\in(406,407.5)$ 区间前段疑似存在接触， $t\in(409,411)$ 区间后端存在疑似接触。  

在细搜之前，先进行排除性判断。一般若发生接触，会有渗透过程，在更细的搜索下能找到实证的接触点（尽管不是全局最优的），如果找到的局部距离最小值无法越过 $0$ ，可以判断是非接触的。 

检查发现 $t\in(406,407.5)$ 情形下，局部最小值为 $0.005386$ ，检查发现 $t\in(409,411)$ 情形下，局部最小值为 $0.000868$ ，均未能跨越 $0$ ，排除了这两种可能性。

进行 $t\in(420,420.5)$ 的逐层细致搜索，在 $10^{-6}$ 精度下可以收敛到 $0.0000000082$ ，此时 $t=412.473838$

代入Problem 1的解决方案，即可得到各个位点的运动学状态。

### Problem 3

整个体系到何处终止，完全由发生Problem 2中所定义的碰撞决定，问题就转化成了：求螺距 $p$ ，使得发生碰撞时满足 

$$\frac{p}{2\pi}\theta_{0}=4.5\tag{10}$$

